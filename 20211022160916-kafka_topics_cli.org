:PROPERTIES:
:ID:       355A2592-CBDA-4B02-BC9B-9F75F3867C62
:END:
#+title: Kafka cli
#+date: 2021-10-22 16:09 PM
#+updated: 2021-10-29 15:45 PM
#+filetags: :kafka:

* kafka-topics
  See also
  https://docs.confluent.io/platform/current/kafka/post-deployment.html#admin-operations

** Adding a topic
    #+begin_src shell
      kafka-topics --bootstrap-server localhost:9092 --topic first_topic --create --partitions 3 --replication-factor 1
    #+end_src

    ~--replication-factor~: how many nodes should partitions be replicated to.
    Must be <= number of brokers in the cluster. 

** Listing topics
    #+begin_src shell
      kafka-topics --bootstrap-server localhost:9092 --list
    #+end_src

** Describe a topic
    Provides partition, leader, Isr, and replicas info

    #+begin_src shell
      kafka-topics --bootstrap-server localhost:9092 --topic first_topic --describe
    #+end_src

** Delete a topic

    #+begin_src shell
    kafka-topics --bootstrap-server localhost:9092 --topic second_topic --delete
    #+end_src

* kafka-console-producer
  Create messages. This opens a prompt where you can add one or more messages.
  Press enter key to add the next message. ~C-c~ to exit prompt.

  #+begin_src shell 
  kafka-console-producer --broker-list 127.0.0.1:9092 --topic first_topic --producer-property acks=all
  #+end_src

  - ~producer-property~ is optional and can be used to add other properties. In
    this example, setting the [[https://docs.confluent.io/platform/current/installation/configuration/producer-configs.html#acks][acks]] property.
  - You can specify a topic that doesn't exist and it will be created. You'll
    get an error the first time a message is posted, but it will recover and
    succeed after the topic is created and a leader is selected.
